const note_code_snippet_event = require('./payloads/note_code_snippet.json');
const note_commit_event = require('./payloads/note_commit.json');
const note_issue_event = require('./payloads/note_issue.json');
const note_merge_request_event = require('./payloads/note_merge_request.json');
const {parseGitLabWebhookNoteEvent} = require('../index');
import * as chai from "chai";
const should = chai.should();

describe('parseGitLabWebhookNoteEvent', function () {
    it(`should return a message on Code Snippet Event`, function () {
        let result = parseGitLabWebhookNoteEvent(note_code_snippet_event);
        should.exist(result);

        result.should.have.property('user');
        console.log(`user: ${result.user}`);
        result.user.should.not.have.string("undefined");
        result.user.should.not.have.string("null");

        result.should.have.property('repository');
        console.log(`repository: ${result.repository}`);
        result.repository.should.not.have.string("undefined");
        result.repository.should.not.have.string("null");


        result.should.have.property('message');
        console.log(`Message: ${result.message}`);
        result.message.should.not.have.string("undefined");
        result.message.should.not.have.string("null");

    })

    it(`should return a message on Commit Event`, function () {
        let result = parseGitLabWebhookNoteEvent(note_commit_event);
        should.exist(result);

        result.should.have.property('user');
        console.log(`user: ${result.user}`);
        result.user.should.not.have.string("undefined");
        result.user.should.not.have.string("null");

        result.should.have.property('repository');
        console.log(`repository: ${result.repository}`);
        result.repository.should.not.have.string("undefined");
        result.repository.should.not.have.string("null");


        result.should.have.property('message');
        console.log(`Message: ${result.message}`);
        result.message.should.not.have.string("undefined");
        result.message.should.not.have.string("null");

    })
    it(`should return a message on Issue Event`, function () {
        let result = parseGitLabWebhookNoteEvent(note_issue_event);
        should.exist(result);

        result.should.have.property('user');
        console.log(`user: ${result.user}`);
        result.user.should.not.have.string("undefined");
        result.user.should.not.have.string("null");

        result.should.have.property('repository');
        console.log(`repository: ${result.repository}`);
        result.repository.should.not.have.string("undefined");
        result.repository.should.not.have.string("null");


        result.should.have.property('message');
        console.log(`Message: ${result.message}`);
        result.message.should.not.have.string("undefined");
        result.message.should.not.have.string("null");

    })

    it(`should return a message on Merge Request Event`, function () {
        let result = parseGitLabWebhookNoteEvent(note_merge_request_event);
        should.exist(result);

        result.should.have.property('user');
        console.log(`user: ${result.user}`);
        result.user.should.not.have.string("undefined");
        result.user.should.not.have.string("null");

        result.should.have.property('repository');
        console.log(`repository: ${result.repository}`);
        result.repository.should.not.have.string("undefined");
        result.repository.should.not.have.string("null");


        result.should.have.property('message');
        console.log(`Message: ${result.message}`);
        result.message.should.not.have.string("undefined");
        result.message.should.not.have.string("null");

    })
})